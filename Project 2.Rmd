---
title: "Project 2"
author: "Collin McGuire"
date: "9/30/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Part 1 - Loading Necessary Packages}
library(tidyverse)
library(tidytuesdayR)
```

```{r Part 1A - Exponential Transformation}
## LMAO WTFn
Exp <- function(x, k){
  if(k == 1) {
   result <- 1 + x
  } else if(k == 2) {
      result <- 1 + x + (x^k)/factorial(k)
  } else{
      output3 <- vector("double", length=(k-2))
      for(i in 3:k) {
        output3 <- c((x^i)/factorial(i))
      }
      vecsum <- sum(output3)
   result <- 1 + x + vecsum
  }
  print(result)
}

Exp(2, 5)


```

```{r Part 1B - Sample Mean and Std Dev}

sample_mean <- function(x) {
  arith_mean <- sum(x)/length(x)
}
  
  
sample_sd <- function(x) {
  l <- length(x)
  m <- sum(x)/l
  for(i in 1:l) {
    sum_of_dif <- c((i-m)^2)
  }
  stddev <- sum_of_dif/(l-1)
}

```


```{r Part 1C - Confidence Intervals}
calculate_CI <- function(x, conf) {
  alpha = 1 - conf
  dof <- length(x)-1
  t_score = qt(p=alpha/2, df = dof, lower.tail = FALSE)
  upper <- sample_mean(x) + (t_score*sample_sd(x))
  lower <- sample_mean(x) - (t_score*sample_sd(x))
  answer <- c(upper, lower)
}


```


```{r Part 2 - Wrangling Data Part 1}
library(here)
if(!file.exists(here("data","tuesdata_rainfall.RDS"))){
  tuesdata <- tidytuesdayR::tt_load('2020-01-07')
  rainfall <- tuesdata$rainfall
  temperature <- tuesdata$temperature
  
  # save the files to RDS objects
  saveRDS(tuesdata$rainfall, file= here("data","tuesdata_rainfall.RDS"))
  saveRDS(tuesdata$temperature, file= here("data","tuesdata_temperature.RDS"))
}

rainfall <- readRDS(here("data","tuesdata_rainfall.RDS"))
temperature <- readRDS(here("data","tuesdata_temperature.RDS"))

drop_na(rainfall) ## Remove any rows with missing data

library(lubridate)
library(stringr)
concat_year <- paste(rainfall$year, rainfall$month, rainfall$day, sep="-")
ymd_year <- ymd(concat_year, quiet = FALSE, tz = NULL)
year_only <- year(ymd_year)
rainfall <- mutate(rainfall, date = ymd_year)
rainfall <- mutate(rainfall, year_only = year_only)
uppercase <- str_to_upper(rainfall$city_name)
rainfall <- mutate(rainfall, city_name = uppercase)
merged_set <- inner_join(x = rainfall, y = temperature, by = c("city_name", "date")) ## This merge is bad currently

```

```{r Part 3: Data Visualization}
library(ggplot2)
twentyfourteen <- merged_set %>%
  filter(year_only >= 2014)
minmax <- twentyfourteen %>%
  group_by(city_name, year_only) %>%
    summarise(max_temp = max(merged_set$temperature, na.rm = TRUE), min_temp = min(merged_set$temperature, na.rm = TRUE), .groups = "keep")

```

```{r Part 3A: Plotting temperature data over time}
base3A <- ggplot(merged_set, aes(x = year_only, y = temperature))
base3A + geom_line()


```


```{r Part 3B: Plotting rainfall over time}




```
